:: Check if the script is running as administrator using PowerShell
powershell -Command "if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) { exit 1 }"
if %errorlevel% neq 0 (
    echo This script requires administrative privileges.
)

:: Minimize the batch file window
if not "%1" == "minimized" (
    start /min cmd /c "%~f0" minimized
    exit
)

:: Run PowerShell script as Administrator
powershell -NoProfile -Command "Start-Process PowerShell -Verb RunAs -ArgumentList '-NoProfile -ExecutionPolicy Bypass -Command \"cd \"$HOME\Downloads\"; .\Malwarermtool.ps1\"'"

:: Wait for the PowerShell script to complete
timeout /t 10 >nul
pause
powershell -NoProfile -Command "Set-ExecutionPolicy Restricted -Scope CurrentUser"
